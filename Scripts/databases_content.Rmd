---
title: "Lipids pathway and network databases content"
author: 
- "DeniseSl22"
date: "30/11/2022"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

## Download and load required libraries
```{r}
# check if libraries are already installed > otherwise install it
if(!requireNamespace("BiocManager", quietly = TRUE)) install.packages("BiocManager",repos = "http://cran.us.r-project.org")
if(!"rstudioapi" %in% installed.packages()) BiocManager::install("rstudioapi")
#load libraries
library(rstudioapi)
# set your working environment to the location where your current source file is saved into.
setwd(dirname(rstudioapi::getSourceEditorContext()$path))
```


## BiGG database
Data downloaded from: http://bigg.ucsd.edu/data_access ; file called bigg_models_metabolites.txt
```{r}
# Obtain Working Directory to find data in Data folder
setwd(dirname(rstudioapi::getSourceEditorContext()$path))
getwd()
setwd('..')
work_DIR <- getwd()

#Library to download data from online files:
if(!"downloader" %in% installed.packages()){install.packages("downloader")}
require(downloader)

##Download new data if needed here:
if(file.exists("Data/bigg_models_metabolites.txt")){print("BiGG already downloaded")}else{
fileUrl <- "http://bigg.ucsd.edu/static/namespace/bigg_models_metabolites.txt"
require(downloader)
download(fileUrl, "Data/bigg_models_metabolites.txt", mode = "wb")
}

## load the data; txt file with headers, tab-separated, some field are empty so needs "fill =TRUE" .
bigg = read.table('Data/bigg_models_metabolites.txt',sep='\t', header = TRUE, fill = TRUE) 
```
## KEGG database
Data will be downloaded from the KEGG API (see KEGG documentation https://www.kegg.jp/kegg/rest/keggapi.html and API calls in R https://www.dataquest.io/blog/r-api-tutorial/)
```{r}
##Install and load required packages:
install.packages(c("httr", "jsonlite", "data.table"))
library(httr)
library(jsonlite)
library(data.table)

## pathway map IDs listed under "1.3 Lipid metabolism"
lipid_kegg_maps <- c("00061", "00062", "00071", "00073", "00100", "00120", "00121", "00140", "00561", "00564", "00565", "00600", "00590", "00591", "00592", "01040")
##Add URL for each item:
lipid_kegg_maps_APIcall <- paste("https://rest.kegg.jp/link/cpd/map", lipid_kegg_maps, sep="")

##Create an empty dataframe to store the results of the loop:
Kegg_total = data.frame()

## Execute API calls, example to obtain chemical compounds for a PW map:
for (i in 1:length(lipid_kegg_maps_APIcall)) {
  res = GET(lipid_kegg_maps_APIcall[i])
  Kegg_data <- rawToChar(res$content)
  cleaned_Kegg_data <- fread(text = Kegg_data, header=FALSE)
  df <- data.frame(cleaned_Kegg_data)
  Kegg_total <- rbind(Kegg_total,df)
}


```


